"use client"

import { createContext, useContext, useEffect, useMemo, useState } from "react"

export type Locale = "en" | "fr"

const STORAGE_KEY = "visaverse_locale"
const COOKIE_KEY = "visaverse_locale"

type Dictionary = Record<string, any>

type I18nContextValue = {
  locale: Locale
  setLocale: (locale: Locale) => void
  t: (key: string) => string
  messages: Dictionary
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined)

const translations: Record<Locale, Dictionary> = {
  en: {
    common: {
      getStarted: "Get Started",
      previous: "Previous",
      next: "Next",
      submit: "Generate Plan",
      editDetails: "Edit Details",
      share: "Share",
      exportPdf: "Export PDF",
      clearChat: "Clear Chat",
      loading: "Loading your experience...",
      languageLabel: "Language",
      skipToContent: "Skip to main content",
    },
    navbar: {
      brand: "VisaVerse",
    },
    home: {
      heroTitle: "Your AI Copilot for Global Mobility",
      heroSubtitle: "Plan your visa, documents, and relocation steps effortlessly with personalized AI-powered guidance.",
      heroCta: "Start Planning",
      featuresTitle: "Everything you need for your journey",
      features: [
        { title: "Document Checklist", description: "Get a personalized list of all required documents for your visa application." },
        { title: "Smart Timeline", description: "AI-generated timeline with milestones and deadlines for your relocation." },
        { title: "Step-by-Step Guide", description: "Clear action items with priority levels to keep you on track." },
        { title: "Risk Analysis", description: "Identify potential challenges and get mitigation strategies." },
      ],
      tipsTitle: "Helpful Tips",
      tips: [
        "Typical visa processing takes 4–8 weeks, so start your planning early.",
        "Make sure your passport is valid 6+ months after your planned departure date.",
        "Keep digital copies of all your documents in a secure cloud storage.",
      ],
      ctaTitle: "Ready to start your journey?",
      ctaSubtitle: "Get your personalized mobility plan in minutes.",
      ctaButton: "Create Your Plan",
    },
    onboarding: {
      title: "Build Your Mobility Plan",
      subtitle: "Tell us about your journey and we will create a personalized plan for you.",
      tipsTitle: "Helpful Tips",
      whatYouGet: "What You Will Get",
      tips: [
        "Typical visa processing takes 4–8 weeks",
        "Make sure your passport is valid 6+ months after departure",
        "Have digital copies of all documents ready",
        "Consider travel insurance early in the process",
      ],
      deliverables: [
        "Personalized document checklist",
        "Smart timeline with milestones",
        "Step-by-step action items",
        "Risk analysis and mitigation",
      ],
      wizard: {
        steps: [
          { title: "Basic Details", description: "Where are you going?" },
          { title: "Travel Info", description: "When and why?" },
          { title: "Additional Details", description: "Financial & other info" },
        ],
        success: {
          title: "Plan generated",
          description: "Your personalized mobility plan is ready.",
        },
        labels: {
          originCountry: "Origin country",
          destinationCountry: "Destination country",
          purpose: "Purpose",
          departureDate: "Departure date",
          duration: "Duration (months)",
          passportExpiry: "Passport expiry date",
          hasSponsor: "Do you have a sponsor?",
          fundsLevel: "Proof of funds",
          language: "Language preference",
          notes: "Notes for your copilot",
        },
        placeholders: {
          originCountry: "e.g., Cameroon",
          destinationCountry: "e.g., France",
          duration: "How long will you stay?",
          notes: "Any special circumstances we should know?",
        },
        errors: {
          originCountry: "Please select your origin country",
          originCountryInvalid: "Please choose a valid origin country",
          destinationCountry: "Please select your destination",
          destinationCountryInvalid: "Please choose a valid destination country",
          destinationSame: "Destination must be different from origin",
          purpose: "Please select your travel purpose",
          departureDate: "Please select a departure date",
          departureFuture: "Departure date must be in the future",
          duration: "Please enter the duration",
          durationInvalid: "Duration must be a positive number",
          passportExpiry: "Please enter your passport expiry date",
          passportBeforeDeparture: "Passport must be valid after your departure date",
          fundsLevel: "Please select your funds level",
          fundsLevelInvalid: "Please choose one of the available levels",
          purposeInvalid: "Please select one of the supported purposes",
          languageInvalid: "Please choose a supported language",
          generic: "Something went wrong. Please try again.",
          submitTitle: "Submission failed",
        },
        toggles: {
          yes: "Yes",
          no: "No",
        },
      },
      options: {
        countries: [
          { value: "us", label: "United States" },
          { value: "uk", label: "United Kingdom" },
          { value: "ca", label: "Canada" },
          { value: "au", label: "Australia" },
          { value: "de", label: "Germany" },
          { value: "fr", label: "France" },
          { value: "in", label: "India" },
          { value: "cn", label: "China" },
          { value: "jp", label: "Japan" },
          { value: "br", label: "Brazil" },
        ],
        purposes: [
          { value: "study", label: "Study" },
          { value: "work", label: "Work" },
          { value: "tourism", label: "Tourism" },
          { value: "family", label: "Family" },
          { value: "business", label: "Business" },
        ],
        funds: [
          { value: "low", label: "Low (Basic requirements)" },
          { value: "medium", label: "Medium (Comfortable)" },
          { value: "high", label: "High (Abundant)" },
        ],
        languages: [
          { value: "en", label: "English" },
          { value: "fr", label: "French" },
        ],
      },
    },
    plan: {
      breadcrumb: {
        home: "Home",
        onboarding: "Onboarding",
        current: "Your Plan",
      },
      title: "Your Mobility Plan",
      subtitle: "Personalized guidance for your journey",
      tabs: {
        summary: "Summary",
        timeline: "Timeline",
        checklist: "Checklist",
        documents: "Documents",
        risks: "Risks",
      },
      nav: {
        previous: "Previous",
        next: "Next",
      },
      emptyState: {
        title: "Complete your profile to view the plan",
        description: "We need your onboarding profile to generate a mobility plan. Please return to onboarding.",
        action: "Go to onboarding",
      },
      loadingMessage: "Generating your personalized plan...",
      errors: {
        loadFailed: "We could not refresh your plan. Please try again.",
        bannerTitle: "Plan generation failed",
        bannerDescription: "We couldn't refresh your plan. You can try again below.",
        retryCta: "Retry",
      },
      noData: {
        recommendationsTitle: "No recommendations yet",
        recommendationsDescription: "Once your plan includes risk insights, they will appear here.",
        timelineTitle: "Timeline unavailable",
        timelineDescription: "We could not compute steps for your journey.",
        checklistTitle: "No checklist items",
        checklistDescription: "Your plan didn't return any action items.",
        documentsTitle: "No documents listed",
        documentsDescription: "The backend did not include document requirements for this profile.",
        risksTitle: "No risks identified",
        risksDescription: "No potential issues were flagged for your situation.",
      },
      summary: {
        overviewTitle: "Plan overview",
        routeLabel: "Route",
        purposeLabel: "Purpose",
        departureLabel: "Departure",
        durationLabel: "Duration",
        durationMonths: "months",
        tbd: "TBD",
        confidenceLabel: "Confidence",
        confidenceHint: "Model confidence in this plan",
        estimatedWeeksLabel: "Estimated weeks",
        estimatedWeeksHint: "Based on departure timeline",
        documentsCountLabel: "Documents count",
        documentsCountHint: "Across all categories",
        documentCollectionTitle: "Document Collection",
        documentCollectionDescription: "Track your progress gathering required documents",
        actionItemsTitle: "Action Items",
        actionItemsDescription: "Complete these tasks before your departure",
        documentsRequiredLabel: "Documents required",
        actionItemsLabel: "Action items",
        weeksEstimatedLabel: "Weeks estimated",
        recommendationsTitle: "Personalized recommendations",
        severityHigh: "High",
        severityMedium: "Action",
        severityLow: "Tip",
      },
      timeline: {
        title: "Your journey timeline",
        subtitle: "Estimated timeline based on your departure date and typical processing times.",
        exportGoogle: "Google",
        exportApple: "Apple",
        exportOutlook: "Outlook",
        exportGoogleToastTitle: "Opening Google Calendar",
        exportGoogleToastDescription: "Add each milestone to your calendar.",
        exportFileToastTitle: "Calendar file downloaded",
        exportFileToastDescriptionApple: "Import the .ics file into Apple Calendar.",
        exportFileToastDescriptionOutlook: "Import the .ics file into Outlook.",
        badgeTbd: "TBD",
        targetLabel: "Target",
        icsFilename: "visaverse-timeline.ics",
        ganttTitle: "Timeline visualization",
        statusCompleted: "Completed",
        statusInProgress: "In progress",
        statusPending: "Pending",
      },
      documents: {
        tipsTitle: "Document preparation tips",
        tipsDescription:
          "All documents should be originals or certified copies. If not in English or French, provide certified translations. Keep both digital and physical copies organized.",
        itemsLabel: "items",
        uploadedLabel: "Uploaded",
        dropTitle: "Drag and drop files here",
        dropOr: "or",
        browse: "Browse files",
        uploadedFiles: "Uploaded files:",
        uploadToastTitle: "Files uploaded",
        uploadToastDescription: "{count} file(s) uploaded for {name}",
        removeToastTitle: "File removed",
        removeToastDescription: "File has been removed from the list",
      },
      risks: {
        assessmentTitle: "Risk assessment",
        assessmentDescription:
          "We have identified potential challenges based on your profile. Review these risks and follow the mitigation strategies to improve your chances of success.",
        mitigationTitle: "Mitigation strategies",
        radarTitle: "Risk assessment",
        radarSubtitle: "Higher scores indicate better preparedness",
        radarPreparedness: "Preparedness",
        radarFallback: ["Financial", "Documentation", "Timeline", "Legal", "Health"],
      },
      fallbacks: {
        checklistSection: "Section",
      },
      checklistProgress: {
        title: "Overall progress",
        count: "{completed} of {total} completed",
      },
      export: {
        windowBlockedTitle: "Unable to open window",
        windowBlockedDescription: "Please allow pop-ups to export the plan.",
        readyTitle: "Export ready",
        readyDescription: "Use your browser's print dialog to save as PDF.",
        profileTitle: "Profile",
        summaryTitle: "Summary",
        timelineTitle: "Timeline",
        checklistTitle: "Checklist",
        documentsTitle: "Documents",
        risksTitle: "Risks",
        generatedAt: "Generated at",
        statusCompleted: "Completed",
        statusPending: "Pending",
        noTimeline: "No timeline data",
        noChecklist: "No checklist items",
        noDocuments: "No documents listed",
        noRisks: "No risks identified",
        fields: {
          origin: "Origin",
          destination: "Destination",
          purpose: "Purpose",
          departure: "Departure",
          duration: "Duration",
          months: "months",
        },
        summaryFields: {
          confidence: "Confidence",
          estimatedWeeks: "Estimated weeks",
          totalDocuments: "Total documents",
          totalTasks: "Total tasks",
        },
      },
    },
    theme: {
      toggleLabel: "Toggle theme",
      light: "Light",
      dark: "Dark",
      system: "System",
    },
    share: {
      title: "Share Your Plan",
      description: "Share your mobility plan with family, friends, or colleagues.",
      linkLabel: "Shareable Link",
      copyToastTitle: "Link Copied",
      copyToastDescription: "The shareable link has been copied to your clipboard.",
      passwordProtect: "Password protect this link",
      passwordLabel: "Password",
      passwordPlaceholder: "Enter password",
      emailLabel: "Or share via email",
      emailPlaceholder: "colleague@example.com",
      emailRequiredTitle: "Email Required",
      emailRequiredDescription: "Please enter an email address.",
      emailSentTitle: "Email Sent",
      emailSentDescription: "Your plan has been shared with {email}",
      close: "Close",
    },
    notifications: {
      title: "Notifications",
      enableTitle: "Enable notifications",
      enableDescription: "Stay updated with important deadlines and reminders",
      enableCta: "Enable Notifications",
      enabledToastTitle: "Notifications enabled",
      enabledToastDescription: "You will receive important deadline reminders",
      blockedToastTitle: "Notifications blocked",
      blockedToastDescription: "Please enable notifications in your browser settings",
      unread: "{count} unread",
      markAllRead: "Mark all as read",
      empty: "No notifications yet",
      newBadge: "New",
      defaults: {
        welcomeTitle: "Welcome to VisaVerse",
        welcomeMessage: "Your personalized visa plan is ready to review",
        deadlineTitle: "Deadline Approaching",
        deadlineMessage: "Document submission deadline in 3 days",
      },
    },
    commandPalette: {
      title: "Command Palette",
      description: "Search and navigate quickly through the app",
      placeholder: "Search commands...",
      empty: "No commands found",
      commands: {
        home: {
          title: "Go to Home",
          description: "Navigate to the homepage",
          keywords: ["home", "landing", "start"],
        },
        onboarding: {
          title: "Start Onboarding",
          description: "Begin or edit your profile",
          keywords: ["onboarding", "profile", "edit", "form"],
        },
        plan: {
          title: "View Plan",
          description: "See your mobility plan",
          keywords: ["plan", "view", "summary"],
        },
        timeline: {
          title: "View Timeline",
          description: "Check your timeline",
          keywords: ["timeline", "schedule", "dates"],
        },
        checklist: {
          title: "View Checklist",
          description: "See your action items",
          keywords: ["checklist", "tasks", "todo"],
        },
        documents: {
          title: "View Documents",
          description: "Check required documents",
          keywords: ["documents", "files", "paperwork"],
        },
        risks: {
          title: "View Risks",
          description: "See potential risks",
          keywords: ["risks", "warnings", "issues"],
        },
        chat: {
          title: "Open Chat",
          description: "Chat with AI copilot",
          keywords: ["chat", "ai", "copilot", "help"],
        },
        export: {
          title: "Export Plan",
          description: "Download your plan as PDF",
          keywords: ["export", "download", "pdf", "save"],
        },
      },
    },
    charts: {
      completed: "Completed",
      remaining: "Remaining",
      itemsCompleted: "{completed} of {total} items completed",
    },
    chat: {
      heroTitle: "Ask Your Copilot",
      heroSubtitle: "Get instant answers to your visa and relocation questions.",
      initialMessage:
        "Hello! I'm your VisaVerse assistant. I can help answer questions about your visa application, required documents, and travel planning. How can I help you today?",
      placeholder: "Type your question...",
      helper: "Press Enter to send, Shift+Enter for new line",
      emptyTitle: "Complete Your Profile First",
      emptyDescription: "To get personalized assistance from your AI copilot, please complete your onboarding profile first.",
      emptyAction: "Start Onboarding",
      suggestedLabel: "Suggested questions:",
      prompts: [
        "What if my passport expires soon?",
        "Do I need health insurance?",
        "When should I book my visa appointment?",
        "How much money do I need to show?",
        "What documents need translation?",
        "Can I expedite the process?",
      ],
      retryError: "I apologize, but I'm having trouble connecting right now. Please try again in a moment.",
      messageFailedTitle: "Message failed",
      statusSending: "Sending...",
      statusRetryReady: "Retry available",
      statusRetryWait: "Retry in {seconds}s",
      retryCta: "Retry now",
      maxLengthHint: "Max {max} characters",
      tooLongError: "Your message is too long. Please shorten it.",
      tooFastError: "Please wait a moment before sending another message.",
    },
  },
  fr: {
    common: {
      getStarted: "Commencer",
      previous: "Précédent",
      next: "Suivant",
      submit: "Générer le plan",
      editDetails: "Modifier",
      share: "Partager",
      exportPdf: "Exporter en PDF",
      clearChat: "Effacer la conversation",
      loading: "Chargement en cours...",
      languageLabel: "Langue",
      skipToContent: "Aller au contenu principal",
    },
    navbar: {
      brand: "VisaVerse",
    },
    home: {
      heroTitle: "Votre copilote IA pour la mobilité internationale",
      heroSubtitle: "Planifiez votre visa, vos documents et vos démarches en toute simplicité grâce à un accompagnement personnalisé.",
      heroCta: "Commencer",
      featuresTitle: "Tout ce dont vous avez besoin pour votre parcours",
      features: [
        { title: "Liste de documents", description: "Recevez une liste personnalisée de toutes les pièces nécessaires à votre demande de visa." },
        { title: "Chronologie intelligente", description: "Une frise générée par l’IA avec jalons et dates clés pour votre relocation." },
        { title: "Guide pas-à-pas", description: "Des actions claires avec niveau de priorité pour rester organisé." },
        { title: "Analyse des risques", description: "Identifiez les obstacles potentiels et découvrez des stratégies d’atténuation." },
      ],
      tipsTitle: "Conseils utiles",
      tips: [
        "Le traitement d’un visa prend généralement 4 à 8 semaines, commencez vos démarches tôt.",
        "Assurez-vous que votre passeport est valide 6+ mois après votre date de départ.",
        "Conservez des copies numériques de tous vos documents dans un espace sécurisé.",
      ],
      ctaTitle: "Prêt à démarrer votre parcours ?",
      ctaSubtitle: "Obtenez votre plan de mobilité personnalisé en quelques minutes.",
      ctaButton: "Créer mon plan",
    },
    onboarding: {
      title: "Construisez votre plan de mobilité",
      subtitle: "Parlez-nous de votre parcours et nous créerons un plan personnalisé.",
      tipsTitle: "Conseils utiles",
      whatYouGet: "Ce que vous recevrez",
      tips: [
        "Le traitement d'un visa prend généralement 4 à 8 semaines",
        "Vérifiez que votre passeport est valide 6+ mois après le départ",
        "Préparez des copies numériques de vos documents",
        "Pensez à l'assurance voyage dès le début",
      ],
      deliverables: [
        "Liste de documents personnalisée",
        "Chronologie intelligente avec jalons",
        "Actions pas-à-pas",
        "Analyse des risques et mitigations",
      ],
      wizard: {
        steps: [
          { title: "Informations de base", description: "Où partez-vous ?" },
          { title: "Infos de voyage", description: "Quand et pourquoi ?" },
          { title: "Détails complémentaires", description: "Finances et autres infos" },
        ],
        success: {
          title: "Plan généré",
          description: "Votre plan de mobilité personnalisé est prêt.",
        },
        labels: {
          originCountry: "Pays d'origine",
          destinationCountry: "Pays de destination",
          purpose: "Motif",
          departureDate: "Date de départ",
          duration: "Durée (mois)",
          passportExpiry: "Expiration du passeport",
          hasSponsor: "Avez-vous un sponsor ?",
          fundsLevel: "Niveau de fonds",
          language: "Langue préférée",
          notes: "Notes pour votre copilote",
        },
        placeholders: {
          originCountry: "ex: Cameroun",
          destinationCountry: "ex: France",
          duration: "Combien de temps resterez-vous ?",
          notes: "Circconstances particulières à mentionner ?",
        },
        errors: {
          originCountry: "Sélectionnez votre pays d'origine",
          originCountryInvalid: "Choisissez un pays d'origine valide",
          destinationCountry: "Sélectionnez votre destination",
          destinationCountryInvalid: "Choisissez un pays de destination valide",
          destinationSame: "La destination doit être différente de l'origine",
          purpose: "Sélectionnez votre motif",
          departureDate: "Sélectionnez une date de départ",
          departureFuture: "La date de départ doit être dans le futur",
          duration: "Indiquez la durée",
          durationInvalid: "La durée doit être un nombre positif",
          passportExpiry: "Indiquez la date d'expiration du passeport",
          passportBeforeDeparture: "Le passeport doit être valide après la date de départ",
          fundsLevel: "Sélectionnez votre niveau de fonds",
          fundsLevelInvalid: "Choisissez l'un des niveaux proposés",
          purposeInvalid: "Sélectionnez l'un des motifs proposés",
          languageInvalid: "Choisissez une langue prise en charge",
          generic: "Une erreur est survenue. Merci de réessayer.",
          submitTitle: "Échec de l'envoi",
        },
        toggles: {
          yes: "Oui",
          no: "Non",
        },
      },
      options: {
        countries: [
          { value: "us", label: "Etats-Unis" },
          { value: "uk", label: "Royaume-Uni" },
          { value: "ca", label: "Canada" },
          { value: "au", label: "Australie" },
          { value: "de", label: "Allemagne" },
          { value: "fr", label: "France" },
          { value: "in", label: "Inde" },
          { value: "cn", label: "Chine" },
          { value: "jp", label: "Japon" },
          { value: "br", label: "Bresil" },
        ],
        purposes: [
          { value: "study", label: "Etudes" },
          { value: "work", label: "Travail" },
          { value: "tourism", label: "Tourisme" },
          { value: "family", label: "Famille" },
          { value: "business", label: "Affaires" },
        ],
        funds: [
          { value: "low", label: "Bas (Minimum requis)" },
          { value: "medium", label: "Moyen (Confortable)" },
          { value: "high", label: "Eleve (Abondant)" },
        ],
        languages: [
          { value: "en", label: "Anglais" },
          { value: "fr", label: "Francais" },
        ],
      },
    },
    plan: {
      breadcrumb: {
        home: "Accueil",
        onboarding: "Onboarding",
        current: "Votre plan",
      },
      title: "Votre plan de mobilité",
      subtitle: "Conseils personnalisés pour votre parcours",
      tabs: {
        summary: "Résumé",
        timeline: "Chronologie",
        checklist: "Checklist",
        documents: "Documents",
        risks: "Risques",
      },
      nav: {
        previous: "Précédent",
        next: "Suivant",
      },
      emptyState: {
        title: "Complétez votre profil pour voir le plan",
        description: "Nous avons besoin de votre profil d'onboarding pour générer un plan de mobilité. Retournez à l'onboarding.",
        action: "Retourner à l'onboarding",
      },
      loadingMessage: "Génération de votre plan personnalisé...",
      errors: {
        loadFailed: "Impossible d'actualiser votre plan. Réessayez.",
        bannerTitle: "Échec de génération du plan",
        bannerDescription: "Nous n'avons pas pu régénérer votre plan. Vous pouvez réessayer ci-dessous.",
        retryCta: "Réessayer",
      },
      noData: {
        recommendationsTitle: "Aucune recommandation",
        recommendationsDescription: "Les recommandations apparaîtront dès que des risques seront identifiés.",
        timelineTitle: "Chronologie indisponible",
        timelineDescription: "Nous n'avons pas pu calculer les étapes pour ce trajet.",
        checklistTitle: "Aucune tâche",
        checklistDescription: "Votre plan n'a retourné aucune action à effectuer.",
        documentsTitle: "Aucun document listé",
        documentsDescription: "Le backend n'a pas fourni de documents requis pour ce profil.",
        risksTitle: "Aucun risque détecté",
        risksDescription: "Aucun risque potentiel n'a été signalé pour cette situation.",
      },
      summary: {
        overviewTitle: "Vue d'ensemble",
        routeLabel: "Trajet",
        purposeLabel: "Motif",
        departureLabel: "Depart",
        durationLabel: "Duree",
        durationMonths: "mois",
        tbd: "A definir",
        confidenceLabel: "Confiance",
        confidenceHint: "Confiance du modele sur ce plan",
        estimatedWeeksLabel: "Semaines estimees",
        estimatedWeeksHint: "Base sur la chronologie de depart",
        documentsCountLabel: "Nombre de documents",
        documentsCountHint: "Toutes categories confondues",
        documentCollectionTitle: "Collecte de documents",
        documentCollectionDescription: "Suivez la collecte des documents requis",
        actionItemsTitle: "Actions a realiser",
        actionItemsDescription: "Completer ces taches avant le depart",
        documentsRequiredLabel: "Documents requis",
        actionItemsLabel: "Actions",
        weeksEstimatedLabel: "Semaines estimees",
        recommendationsTitle: "Recommandations personnalisees",
        severityHigh: "Eleve",
        severityMedium: "Action",
        severityLow: "Conseil",
      },
      timeline: {
        title: "Chronologie du parcours",
        subtitle: "Chronologie estimee selon la date de depart et les delais habituels.",
        exportGoogle: "Google",
        exportApple: "Apple",
        exportOutlook: "Outlook",
        exportGoogleToastTitle: "Ouverture de Google Calendar",
        exportGoogleToastDescription: "Ajoutez chaque jalon a votre calendrier.",
        exportFileToastTitle: "Fichier calendrier telecharge",
        exportFileToastDescriptionApple: "Importez le fichier .ics dans Apple Calendar.",
        exportFileToastDescriptionOutlook: "Importez le fichier .ics dans Outlook.",
        badgeTbd: "A definir",
        targetLabel: "Cible",
        icsFilename: "visaverse-timeline.ics",
        ganttTitle: "Visualisation de la chronologie",
        statusCompleted: "Termine",
        statusInProgress: "En cours",
        statusPending: "En attente",
      },
      documents: {
        tipsTitle: "Conseils de preparation",
        tipsDescription:
          "Tous les documents doivent etre des originaux ou copies certifiees. Si un document n'est pas en francais ou en anglais, fournissez une traduction certifiee. Conservez des copies numeriques et papier.",
        itemsLabel: "elements",
        uploadedLabel: "Televerse",
        dropTitle: "Deposez les fichiers ici",
        dropOr: "ou",
        browse: "Parcourir les fichiers",
        uploadedFiles: "Fichiers televerses :",
        uploadToastTitle: "Fichiers televerses",
        uploadToastDescription: "{count} fichier(s) televerses pour {name}",
        removeToastTitle: "Fichier supprime",
        removeToastDescription: "Le fichier a ete retire de la liste",
      },
      risks: {
        assessmentTitle: "Evaluation des risques",
        assessmentDescription:
          "Nous avons identifie des risques potentiels selon votre profil. Consultez-les et suivez les strategies de mitigation.",
        mitigationTitle: "Strategies de mitigation",
        radarTitle: "Evaluation des risques",
        radarSubtitle: "Un score plus eleve indique une meilleure preparation",
        radarPreparedness: "Preparation",
        radarFallback: ["Financier", "Documents", "Chronologie", "Legal", "Sante"],
      },
      fallbacks: {
        checklistSection: "Section",
      },
      checklistProgress: {
        title: "Progression globale",
        count: "{completed} sur {total} terminées",
      },
      export: {
        windowBlockedTitle: "Fenêtre bloquée",
        windowBlockedDescription: "Autorisez les pop-ups pour exporter le plan.",
        readyTitle: "Export prêt",
        readyDescription: "Utilisez la fenêtre d'impression pour enregistrer en PDF.",
        profileTitle: "Profil",
        summaryTitle: "Résumé",
        timelineTitle: "Chronologie",
        checklistTitle: "Checklist",
        documentsTitle: "Documents",
        risksTitle: "Risques",
        generatedAt: "Généré le",
        statusCompleted: "Terminé",
        statusPending: "En attente",
        noTimeline: "Aucune chronologie",
        noChecklist: "Aucune tâche",
        noDocuments: "Aucun document listé",
        noRisks: "Aucun risque identifié",
        fields: {
          origin: "Origine",
          destination: "Destination",
          purpose: "Motif",
          departure: "Départ",
          duration: "Durée",
          months: "mois",
        },
        summaryFields: {
          confidence: "Confiance",
          estimatedWeeks: "Semaines estimées",
          totalDocuments: "Documents",
          totalTasks: "Tâches",
        },
      },
    },
    theme: {
      toggleLabel: "Changer le thème",
      light: "Clair",
      dark: "Sombre",
      system: "Système",
    },
    share: {
      title: "Partager votre plan",
      description: "Partagez votre plan de mobilité avec votre entourage.",
      linkLabel: "Lien de partage",
      copyToastTitle: "Lien copié",
      copyToastDescription: "Le lien de partage a été copié dans le presse-papiers.",
      passwordProtect: "Protéger ce lien par mot de passe",
      passwordLabel: "Mot de passe",
      passwordPlaceholder: "Entrer le mot de passe",
      emailLabel: "Ou partager par email",
      emailPlaceholder: "collegue@example.com",
      emailRequiredTitle: "Email requis",
      emailRequiredDescription: "Veuillez saisir une adresse email.",
      emailSentTitle: "Email envoyé",
      emailSentDescription: "Votre plan a été partagé avec {email}",
      close: "Fermer",
    },
    notifications: {
      title: "Notifications",
      enableTitle: "Activer les notifications",
      enableDescription: "Recevez les rappels des échéances importantes",
      enableCta: "Activer les notifications",
      enabledToastTitle: "Notifications activées",
      enabledToastDescription: "Vous recevrez des rappels importants",
      blockedToastTitle: "Notifications bloquées",
      blockedToastDescription: "Activez les notifications dans votre navigateur",
      unread: "{count} non lues",
      markAllRead: "Tout marquer comme lu",
      empty: "Aucune notification pour l'instant",
      newBadge: "Nouveau",
      defaults: {
        welcomeTitle: "Bienvenue sur VisaVerse",
        welcomeMessage: "Votre plan visa personnalisé est prêt",
        deadlineTitle: "Échéance proche",
        deadlineMessage: "Date limite de dépôt dans 3 jours",
      },
    },
    commandPalette: {
      title: "Palette de commandes",
      description: "Recherchez et naviguez rapidement dans l'application",
      placeholder: "Rechercher une commande...",
      empty: "Aucune commande trouvée",
      commands: {
        home: {
          title: "Aller à l'accueil",
          description: "Naviguer vers la page d'accueil",
          keywords: ["accueil", "depart", "start"],
        },
        onboarding: {
          title: "Démarrer l'onboarding",
          description: "Commencer ou modifier votre profil",
          keywords: ["onboarding", "profil", "modifier", "formulaire"],
        },
        plan: {
          title: "Voir le plan",
          description: "Consulter votre plan de mobilité",
          keywords: ["plan", "resume", "voir"],
        },
        timeline: {
          title: "Voir la chronologie",
          description: "Consulter votre calendrier",
          keywords: ["chronologie", "calendrier", "dates"],
        },
        checklist: {
          title: "Voir la checklist",
          description: "Consulter vos tâches",
          keywords: ["checklist", "taches", "todo"],
        },
        documents: {
          title: "Voir les documents",
          description: "Consulter les documents requis",
          keywords: ["documents", "fichiers", "papier"],
        },
        risks: {
          title: "Voir les risques",
          description: "Consulter les risques potentiels",
          keywords: ["risques", "alertes", "problemes"],
        },
        chat: {
          title: "Ouvrir le chat",
          description: "Discuter avec l'IA",
          keywords: ["chat", "ia", "assistant", "aide"],
        },
        export: {
          title: "Exporter le plan",
          description: "Telecharger votre plan en PDF",
          keywords: ["export", "telecharger", "pdf", "sauvegarde"],
        },
      },
    },
    charts: {
      completed: "Termine",
      remaining: "Restant",
      itemsCompleted: "{completed} sur {total} elements termines",
    },
    chat: {
      heroTitle: "Posez vos questions",
      heroSubtitle: "Obtenez des réponses instantanées sur votre visa et votre installation.",
      initialMessage:
        "Bonjour ! Je suis votre assistant VisaVerse. Je peux répondre sur votre demande de visa, les documents requis et la planification du voyage. Comment puis-je vous aider aujourd'hui ?",
      placeholder: "Tapez votre question...",
      helper: "Entrée pour envoyer, Maj+Entrée pour une nouvelle ligne",
      emptyTitle: "Complétez d'abord votre profil",
      emptyDescription: "Pour obtenir une assistance personnalisée, veuillez compléter votre profil d'onboarding.",
      emptyAction: "Commencer l'onboarding",
      suggestedLabel: "Questions suggérées :",
      prompts: [
        "Que faire si mon passeport expire bientôt ?",
        "Ai-je besoin d'une assurance santé ?",
        "Quand réserver mon rendez-vous visa ?",
        "Combien de fonds dois-je prouver ?",
        "Quels documents doivent être traduits ?",
        "Puis-je accélérer la procédure ?",
      ],
      retryError: "Désolé, je n'arrive pas à me connecter. Réessayez dans un instant.",
      messageFailedTitle: "Échec du message",
      statusSending: "Envoi...",
      statusRetryReady: "Retry disponible",
      statusRetryWait: "Retry dans {seconds}s",
      retryCta: "Réessayer",
      maxLengthHint: "Max {max} caractères",
      tooLongError: "Votre message est trop long. Raccourcissez-le.",
      tooFastError: "Veuillez patienter avant d'envoyer un autre message.",
    },
  },
}

function resolveKey(locale: Locale, key: string): string {
  const parts = key.split(".")
  let current: any = translations[locale]
  for (const part of parts) {
    if (current && part in current) {
      current = current[part]
    } else {
      return key
    }
  }
  if (typeof current === "string") return current
  return Array.isArray(current) ? current.join(" ") : key
}

export function I18nProvider({
  children,
  initialLocale = "en",
}: {
  children: React.ReactNode
  initialLocale?: Locale
}) {
  const [locale, setLocaleState] = useState<Locale>(initialLocale)

  const setLocale = (value: Locale) => {
    setLocaleState(value)
    if (typeof window !== "undefined") {
      window.localStorage.setItem(STORAGE_KEY, value)
      document.cookie = `${COOKIE_KEY}=${value}; path=/; max-age=31536000`
    }
  }

  const value = useMemo(
    () => ({
      locale,
      setLocale,
      t: (key: string) => resolveKey(locale, key),
      messages: translations[locale],
    }),
    [locale],
  )

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>
}

export function useI18n() {
  const ctx = useContext(I18nContext)
  if (!ctx) {
    throw new Error("useI18n must be used within I18nProvider")
  }
  return ctx
}
